+++
author = "sin1111yi"
title = "Rustå­¦ä¹ ç¬”è®°.part2.1"
date = "2024-02-27"
description = "åƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ã€‚"
tags = [
    "rust", "note"
]
series = ["Rust Study"]
+++

æ ‡é‡ç±»å‹

<!--more-->

ä»é›¶å¼€å§‹å­¦ä¹ rustï¼Œå‚è€ƒä¹¦ç±[Rustç¨‹åºè®¾è®¡è¯­è¨€](https://kaisery.github.io/trpl-zh-cn/)ï¼ŒåŸå§‹ä»“åº“ [rust-lang/book](https://github.com/rust-lang/book)ã€‚

- [æ•°æ®ç±»å‹](#æ•°æ®ç±»å‹)
  - [æ ‡é‡ç±»å‹](#æ ‡é‡ç±»å‹)
    - [æ•´å‹](#æ•´å‹)
    - [æµ®ç‚¹](#æµ®ç‚¹)
    - [æ•°å€¼è¿ç®—](#æ•°å€¼è¿ç®—)
    - [å¸ƒå°”ç±»å‹](#å¸ƒå°”ç±»å‹)
    - [å­—ç¬¦ç±»å‹](#å­—ç¬¦ç±»å‹)
- [ä¸€äº›æœ¯è¯­](#ä¸€äº›æœ¯è¯­)

## æ•°æ®ç±»å‹

ä¸¤ç§æ•°æ®ç±»å‹å­é›†ï¼šæ ‡é‡å’Œå¤åˆã€‚Rustæ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶å°±éœ€è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚

### æ ‡é‡ç±»å‹

#### æ•´å‹

Rust built-in æ•´æ•°ç±»å‹ï¼Œæ•°å­—ç±»å‹é»˜è®¤æ˜¯ `i32`ï¼Œ`isize` å’Œ `usize` ä¸»è¦ä½œä¸ºæŸäº›é›†åˆçš„ç´¢å¼•ã€‚

|  é•¿åº¦   | æœ‰ç¬¦å· | æ— ç¬¦å· |
| :-----: | :----: | :----: |
|  8-bit  |   i8   |   u8   |
| 16-bit  |  i16   |  u16   |
| 32-bit  |  i32   |  u32   |
| 64-bit  |  i64   |  u64   |
| 128-bit |  i128  |  u128  |
|  arch   | isize  | usize  |

`isize` å’Œ `usize` ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼š64 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œ32 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 32 ä½çš„ã€‚

å¤šç§æ•°å­—ç±»å‹çš„æ•°å­—å­—é¢å€¼å…è®¸ä½¿ç”¨ç±»å‹åç¼€ï¼Œä¾‹å¦‚ 57u8 æ¥æŒ‡å®šç±»å‹ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä½¿ç”¨ _ åšä¸ºåˆ†éš”ç¬¦ä»¥æ–¹ä¾¿è¯»æ•°ï¼Œä¾‹å¦‚1_000ï¼Œå®ƒçš„å€¼å’Œ 1000 ç›¸åŒã€‚

```rust
let dec = 98_222; // åè¿›åˆ¶
let hex = 0xffff; // åå…­è¿›åˆ¶
let oct = 0o7878; // å…«è¿›åˆ¶
let bin = 0b1111_0000; // äºŒè¿›åˆ¶
let chr: u8 = b'A'; // å­—ç¬¦ï¼Œä»…é™ u8 ç±»å‹
```

> æ•´å‹æº¢å‡º

>> æ¯”å¦‚ u8 çš„å­˜å‚¨èŒƒå›´ä¸º0è‡³255ï¼Œå¦‚æœå‘ç”Ÿå°†256å†™å…¥ï¼Œå°±ä¼šå‘ç”Ÿæº¢å‡ºï¼Œå½“ä½¿ç”¨ debug æ¨¡å¼æ„å»ºæ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¿™ä¸€ç±»é—®é¢˜å¹¶ä½¿ç¨‹åº panicï¼Œè¿™ä¸ªå±äºè¢«Rustç”¨æ¥è¡¨æ˜ç¨‹åºé”™è¯¯è€Œé€€å‡ºã€‚

>> ä½¿ç”¨ `--release` flag åœ¨ release æ¨¡å¼æ„å»ºæ—¶ï¼ŒRustä¸ä¼šæ£€æµ‹ä¼šå¯¼è‡´panicçš„æ•´å‹æº¢å‡ºï¼Œè€Œä¼šè¿›è¡ŒäºŒè¿›åˆ¶è¡¥ç wrappingï¼Œå³å¦‚æœå‘u8ä¸­å†™å…¥256ï¼Œå®é™…ä¸Šä¼šå†™å…¥0ï¼Œå†™å…¥257ï¼Œå®é™…ä¸Šä¼šå†™å…¥1ï¼Œè€Œç¨‹åºä¸ä¼španicã€‚

>> ä¾èµ–æ•´å‹æº¢å‡ºwrappingçš„è¡Œä¸ºè¢«è®¤ä¸ºæ˜¯ä¸€ç§é”™è¯¯ã€‚

>> ä¸ºäº†æ˜¾å¼åœ°å¤„ç†æº¢å‡ºçš„å¯èƒ½æ€§ï¼Œå¯ä»¥ä½¿ç”¨è¿™å‡ ç±»æ ‡å‡†åº“æä¾›çš„åŸå§‹æ•°å­—ç±»å‹æ–¹æ³•ï¼š

>> - æ‰€æœ‰æ¨¡å¼ä¸‹éƒ½å¯ä»¥ä½¿ç”¨ `wrapping_*` æ–¹æ³•è¿›è¡Œ wrappingï¼Œå¦‚ `wrapping_add`
>> - å¦‚æœ `checked_*` æ–¹æ³•å‡ºç°æº¢å‡ºï¼Œåˆ™è¿”å› `None` å€¼
>> - ç”¨ `overflowing_*` æ–¹æ³•è¿”å›å€¼å’Œä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å‡ºç°æº¢å‡º
>> - ç”¨ `saturating_*` æ–¹æ³•åœ¨å€¼çš„æœ€å°å€¼æˆ–æœ€å¤§å€¼å¤„è¿›è¡Œé¥±å’Œå¤„ç†

#### æµ®ç‚¹

Rust ä¹Ÿæœ‰ä¸¤ä¸ªåŸç”Ÿçš„æµ®ç‚¹æ•°ç±»å‹â€”â€” `f32` å’Œ `f64`ï¼Œåˆ†åˆ«å 32ä½å’Œ64ä½ï¼Œé»˜è®¤ç±»å‹éƒ½æ˜¯f64ï¼Œæ‰€æœ‰çš„æµ®ç‚¹å‹éƒ½æ˜¯æœ‰ç¬¦å·çš„ã€‚

```rust
fn main() {
    let x = 2.0; // f64
    let y: f32 = 3.0; // f32
}
```

æµ®ç‚¹æ•°é‡‡ç”¨ IEEE-754 æ ‡å‡†è¡¨ç¤ºã€‚`f32` æ˜¯å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œ`f64` æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚

#### æ•°å€¼è¿ç®—

æ‰€æœ‰æ•°å­—ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ å‡ä¹˜é™¤å’Œå–ä½™ã€‚æ•´æ•°é™¤æ³•ä¼šå‘é›¶èˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚

```rust
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;
    let truncated = -5 / 3; // -1

    // remainder
    let remainder = 43 % 5;
}
```
[é™„å½• B](https://kaisery.github.io/trpl-zh-cn/appendix-02-operators.html) åŒ…å« Rust æä¾›çš„æ‰€æœ‰è¿ç®—ç¬¦çš„åˆ—è¡¨ã€‚

#### å¸ƒå°”ç±»å‹

ä¸¤ä¸ªçœŸå€¼ï¼Œ`true` å’Œ `false`ã€‚ä½¿ç”¨ `bool` è¡¨ç¤ºã€‚
```rust
fn main() {
    let t = true;
    let f: bool = false; // with explicit type annotation
}
```

#### å­—ç¬¦ç±»å‹

Rust ä¸­çš„ `char` æ˜¯è¯­è¨€ä¸­æœ€åŸç”Ÿçš„å­—ç¬¦ç±»å‹ã€‚

```rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤';
    let emoji = 'ğŸ˜€';
}
```

è¿™é‡Œçš„åé¢ä¸¤ä¸ªå˜é‡zå’Œemojiçš„æ˜¾ç¤ºå¯èƒ½éœ€è¦ä¾èµ– nerd font å’Œ noto-fonts-emojiã€‚

ç”¨å•å¼•å·å£°æ˜å­—ç¬¦ï¼Œä½¿ç”¨åŒå¼•å·å£°æ˜å­—ç¬¦ä¸²ã€‚åœ¨ Rust ä¸­ char ç±»å‹çš„å¤§å°ä¸º 4 Bytesï¼Œä»£è¡¨äº†ä¸€ä¸ªUnicodeæ ‡é‡å€¼ï¼Œå¯ä»¥æ¯” ASCII è¡¨ç¤ºæ›´å¤šå†…å®¹ã€‚Unicode æ ‡é‡å€¼åŒ…å«ä» `U+0000` åˆ° `U+D7FF` å’Œ `U+E000` åˆ° `U+10FFFF` åœ¨å†…çš„å€¼ã€‚

## ä¸€äº›æœ¯è¯­

æ ‡é‡ - scalar

å¤åˆ - compound

é™æ€ç±»å‹ - statically typed

æ•´å‹æº¢å‡º - integer overflow

äºŒè¿›åˆ¶è¡¥ç  wrapping - twoâ€™s complement wrapping

æµ®ç‚¹æ•° - floating-point numbers